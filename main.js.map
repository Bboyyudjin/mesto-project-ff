{"version":3,"file":"main.js","mappings":"mBAAO,SAASA,EAAYC,EAAMC,EAAcC,EAAYC,EAASC,EAAgBC,GACnF,IAAMC,EAAUL,EAAaM,cAAc,SAASC,WAAU,GACxDC,EAAYH,EAAQC,cAAc,gBAClCG,EAAaJ,EAAQC,cAAc,sBACnCI,EAAeL,EAAQC,cAAc,wBAsB3C,OArBAE,EAAUG,IAAMZ,EAAKa,KACrBJ,EAAUK,IAAMd,EAAKe,KACrBN,EAAUO,iBAAiB,SAAQ,kBAAMZ,EAAeK,EAAU,IAClEH,EAAQC,cAAc,gBAAgBU,YAAcjB,EAAKe,KACrDf,EAAKkB,MAAMC,MAAQd,EACrBM,EAAaK,iBAAiB,SAAS,YAmB3C,SAA4BhB,GAC1BA,EAAKoB,QACP,EArBkDC,CAAmBf,GAAUJ,EAAWF,EAAK,IAE3FW,EAAaW,MAAMC,QAAU,OAE/BjB,EAAQC,cAAc,qBAAqBU,YAAcjB,EAAKwB,MAAMC,OACpEf,EAAWM,iBAAiB,SAAS,WACnCb,EAAQH,EAAMK,GACXqB,MAAM,SAACC,GACN3B,EAAKwB,MAAQG,EAAIH,MACjBlB,EAAQC,cAAc,qBAAqBU,YAAcU,EAAIH,MAAMC,MACrE,IAaN,SAAcf,GACZA,EAAWkB,UAAUC,OAAO,8BAC9B,CAdIC,CAAKpB,EACP,IACIV,EAAKwB,MAAMO,MAAK,SAAAC,GAAI,OAAIA,EAAKb,MAAQd,CAAM,KAC7CK,EAAWkB,UAAUK,IAAI,+BAEpB3B,CACT,CCXA,SAAS4B,EAAgBC,GACP,WAAZA,EAAIC,KAENC,EADcC,SAAS/B,cAAc,oBAGzC,CAEO,SAASgC,EAAUC,GACxBA,EAAMZ,UAAUK,IAAI,mBACpBK,SAAStB,iBAAiB,UAAWkB,EACvC,CAEO,SAASG,EAAWG,GACzBA,EAAMZ,UAAUR,OAAO,mBACvBkB,SAASG,oBAAoB,UAAWP,EAC1C,CAEO,SAASQ,EAAQF,EAAOG,GAChBH,EAAMjC,cAAc,kBAE1BU,YADL0B,EACmB,gBAEA,WAEvB,CCxCA,IAAMC,EAAmB,CACvBC,aAAc,eACdC,cAAe,gBACfC,qBAAsB,iBACtBC,oBAAqB,yBACrBC,gBAAiB,0BACjBC,WAAY,uBACZC,kBAAmB,wBAefC,EAAiB,SAACC,EAAaC,GACnC,IAAMC,EAAeF,EAAY9C,cAAc,IAADiD,OAAKF,EAAaG,GAAE,WAClEH,EAAa1B,UAAUR,OAAOwB,EAAiBK,iBAC/CK,EAAa1B,UAAUR,OAAOwB,EAAiBO,mBAC/CI,EAAa3B,UAAUR,OAAOwB,EAAiBM,YAC/CK,EAAatC,YAAc,EAC7B,EAiCayC,EAAkB,SAACL,GACZM,MAAMC,KAAKP,EAAYQ,iBAAiBjB,EAAiBE,gBACjEgB,SAAQ,SAACR,GACfF,EAAeC,EAAaC,EAChC,IACA,IAAMS,EAAgBV,EAAY9C,cAAcqC,EAAiBG,sBACjEgB,EAAcC,UAAW,EACzBD,EAAcnC,UAAUK,IAAIW,EAAiBI,oBAC/C,EAQMiB,EAAoB,SAACC,EAAWH,IANd,SAACG,GACvB,OAAOA,EAAUnC,MAAK,SAACuB,GACvB,OAAQA,EAAaa,SAASC,KAChC,GACA,CAGMC,CAAgBH,IAIpBH,EAAcC,UAAW,EACzBD,EAAcnC,UAAUR,OAAOwB,EAAiBI,uBAJ9Ce,EAAcC,UAAW,EACzBD,EAAcnC,UAAUK,IAAIW,EAAiBI,qBAKjD,ECrFMsB,EAAS,CACbC,QAAS,4CACTC,QAAS,CACPC,cAAe,uCACf,eAAgB,qBA0CPvE,EAAa,SAACF,GACzB,OAAO0E,MAAM,GAADlB,OAAIc,EAAOC,QAAO,WAAAf,OAAUxD,EAAKmB,KAAO,CAClDwD,OAAQ,SACRH,QAASF,EAAOE,UAEjB9C,KAAKkD,EACR,EAEazE,EAAU,SAACH,EAAMK,GAC5B,IAAMsE,EAAS3E,EAAKwB,MAAMO,MAAK,SAAAC,GAAI,OAAIA,EAAKb,MAAQd,CAAM,IAAI,SAAW,MACzE,OAAOqE,MAAM,GAADlB,OAAIc,EAAOC,QAAO,iBAAAf,OAAgBxD,EAAKmB,KAAO,CACtDwD,OAAQA,EACRH,QAASF,EAAOE,UAEnB9C,KAAKkD,EACR,EAaMA,EAAa,SAACjD,GAClB,OAAIA,EAAIkD,GACGlD,EAAImD,OAERC,QAAQC,OAAO,WAADxB,OAAY7B,EAAIsD,QACvC,E,sGCzEA,IASI5E,EATEJ,EAAeqC,SAAS/B,cAAc,kBAAkB2E,QACxDC,EAAW7C,SAAS/B,cAAc,iBAClC6E,EAAgB9C,SAAS/B,cAAc,oBACvC8E,EAAe/C,SAAS/B,cAAc,wBACtC+E,EAAahD,SAAS/B,cAAc,qBACpCgF,EAAcjD,SAAS/B,cAAc,sBACrCiF,EAAgBlD,SAAS/B,cAAc,mBACvCkF,EAAcnD,SAAS/B,cAAc,mBACrCmF,EAAepD,SAAS/B,cAAc,yBFyCzBoD,MAAMC,KAAKtB,SAASuB,iBAAiBjB,EAAiBC,eAC9DiB,SAAQ,SAACT,IAlBM,SAACA,GACzB,IAAMa,EAAYP,MAAMC,KAAKP,EAAYQ,iBAAiBjB,EAAiBE,gBACrEiB,EAAgBV,EAAY9C,cAAcqC,EAAiBG,sBAGjEkB,EAAkBC,EAAWH,GAE7BG,EAAUJ,SAAQ,SAACR,GACjBA,EAAatC,iBAAiB,SAAS,YAhBhB,SAACqC,EAAaC,GAClCA,EAAaa,SAASC,MAGzBhB,EAAeC,EAAaC,GAxBT,SAACD,EAAaC,GACnC,IAAMC,EAAeF,EAAY9C,cAAc,IAADiD,OAAKF,EAAaG,GAAE,WAClEH,EAAa1B,UAAUK,IAAIW,EAAiBK,iBAC5CK,EAAa1B,UAAUK,IAAIW,EAAiBO,mBAC5CI,EAAa3B,UAAUK,IAAIW,EAAiBM,YACxCI,EAAaa,SAASwB,gBACxBpC,EAAatC,YAAcqC,EAAasC,QAAQC,aAEhDtC,EAAatC,YAAcqC,EAAawC,iBAE5C,CAYIC,CAAe1C,EAAaC,EAIhC,EAWM0C,CAAmB3C,EAAaC,GAEhCW,EAAkBC,EAAWH,EAC/B,GACF,GACF,CAKIkC,CAAkB5C,EACpB,IEtCFf,SAAS/B,cAAc,yBAAyBS,iBAAiB,SAAQ,WAAOuB,EAAU6C,GAAgBc,IAAsBxC,EAAgB0B,EAAc,IAC9J9C,SAAS/B,cAAc,wBAAwBS,iBAAiB,SAAQ,WAAOuB,EAAU8C,GAAec,IAAuBzC,EAAgB2B,EAAa,IAC5J/C,SAAS/B,cAAc,mBAAmBS,iBAAiB,SAAQ,WAAOuB,EAAUgD,GAAca,IAAsB1C,EAAgB6B,EAAY,IACpJjD,SAASuB,iBAAiB,UAAUC,SAAQ,SAAAtB,GAAK,OHtB1C,SAA2BA,GAChCA,EAAMjC,cAAc,iBAAiBS,iBAAiB,SAAQ,kBAIhE,SAA4BwB,GAC1BH,EAAWG,EACb,CANsE6D,CAAmB7D,EAAM,IAC7FA,EAAMxB,iBAAiB,SAAQ,SAACmB,GAAG,OAOrC,SAA8BK,EAAOL,GAC/BA,EAAImE,SAAW9D,GACjBH,EAAWG,EAEf,CAX0C+D,CAAqB/D,EAAOL,EAAI,GAC1E,CGmBqDqE,CAAkBhE,EAAM,IAG7E,IAAMiE,EAAkBnE,SAAS/B,cAAc,qCACzCmG,EAAcpE,SAAS/B,cAAc,kCACrCoG,EAAgBrE,SAAS/B,cAAc,sCACvCqG,EAAYH,EAAgBlG,cAAc,2BAC1CsG,EAAWJ,EAAgBlG,cAAc,kCACzCuG,EAAcH,EAAcpG,cAAc,6BAGhD,SAAS2F,IACPU,EAAUG,MAAQtB,EAAYxE,YAC9B4F,EAASE,MAAQrB,EAAazE,WAChC,CAEAiF,IAmBAO,EAAgBzF,iBAAiB,UAhBjC,SAAiCmB,GDpBH,IAACpB,EAAMiG,ECqBjC7E,EAAI8E,iBACJxB,EAAYxE,YAAc2F,EAAUG,MACpCrB,EAAazE,YAAc4F,EAASE,MACpCrE,EAAQ0C,GAAe,IDxBIrE,ECyBZ6F,EAAUG,MDzBQC,ECyBDH,EAASE,MDxBpCrC,MAAM,GAADlB,OAAIc,EAAOC,QAAO,aAAa,CACzCI,OAAQ,QACRH,QAASF,EAAOE,QAChB0C,KAAMC,KAAKC,UAAU,CACnBrG,KAAM,GAAFyC,OAAKzC,GACTiG,MAAO,GAAFxD,OAAKwD,OAGbtF,KAAKkD,ICiBDlD,KAAMW,EAAW+C,IACjBiC,OAAM,SAAAC,GACLC,QAAQC,IAAIF,EACd,IACCG,SAAS,WACR/E,EAAQ0C,GAAe,EACzB,GAEN,IAKA,IAAMsC,EAAgBrC,EAAa9E,cAAc,gCAC3CoH,EAAWtC,EAAa9E,cAAc,0BAE5C,SAAS4F,IACPuB,EAAcX,MAAQ,GACtBY,EAASZ,MAAQ,EACnB,CAyBA,SAAS3G,EAAeJ,GACtBuC,EAAU+C,GACVA,EAAW/E,cAAc,iBAAiBK,IAAMZ,EAAKY,IACrD0E,EAAW/E,cAAc,iBAAiBO,IAAMd,EAAKc,IACrDwE,EAAW/E,cAAc,mBAAmBU,YAAcjB,EAAKc,GACjE,CAIA,SAASsF,IACPU,EAAYC,MAAQ,EACtB,CAbAL,EAAY1F,iBAAiB,UArB7B,SAAoBmB,GAClBA,EAAI8E,iBACJ,IAAM3G,EAAU,GAChBA,EAAQS,KAAO2G,EAAcX,MAC7BzG,EAAQO,KAAO8G,EAASZ,MACxBrE,EAAQ2C,GAAc,GDxCD,SAAC/E,GACtB,OAAOoE,MAAM,GAADlB,OAAIc,EAAOC,QAAO,UAAU,CACtCI,OAAQ,OACRH,QAASF,EAAOE,QAChB0C,KAAMC,KAAKC,UAAU,CACnBrG,KAAM,GAAFyC,OAAKlD,EAAQS,MACjBF,KAAM,GAAF2C,OAAKlD,EAAQO,UAGpBa,KAAMkD,EACT,CC+BEgD,CAAQtH,GACLoB,MAAK,SAAApB,GACJ,IAAMuH,EAAc9H,EAAYO,EAASL,EAAcC,EAAYC,EAASC,EAAgBC,GAC5F8E,EAAS2C,QAAQD,GACjBxF,EAAWgD,GACXc,GACF,IACCkB,OAAM,SAAAC,GACLC,QAAQC,IAAIF,EACd,IACCG,SAAS,WACR/E,EAAQ2C,GAAc,EACxB,GACJ,IAWAsB,EAAc3F,iBAAiB,UAM/B,SAA4BmB,GD1CA,IAAC4F,EC2C3B5F,EAAI8E,iBACJzB,EAAclE,MAAM0G,gBAAkB,OAAHxE,OAAUsD,EAAYC,MAAK,KAC9DrE,EAAQ6C,GAAa,ID7CMwC,EC8CdjB,EAAYC,MD7ClBrC,MAAM,GAADlB,OAAIc,EAAOC,QAAO,oBAAoB,CAChDI,OAAQ,QACRH,QAASF,EAAOE,QAChB0C,KAAMC,KAAKC,UAAU,CACnBa,OAAQF,MAGXrG,KAAKkD,ICuCHlD,KAAMW,EAAWkD,IACjB8B,OAAM,SAAAC,GACLC,QAAQC,IAAIF,EACd,IACCG,SAAS,WACR/E,EAAQ6C,GAAa,EACvB,IACFa,GACF,IAGArB,QAAQmD,IAAI,CDzGHxD,MAAM,GAADlB,OAAIc,EAAOC,QAAO,aAAa,CACzCC,QAASF,EAAOE,UAEjB9C,KAAKkD,GAVCF,MAAM,GAADlB,OAAIc,EAAOC,QAAO,UAAU,CACtCC,QAASF,EAAOE,UAEjB9C,KAAKkD,KC8GLlD,MAAK,SAAAyG,GAA2B,I,IAAAC,G,EAAA,E,4CAAAD,I,s1BAAzBE,EAAQD,EAAA,GAAEE,EAASF,EAAA,GACvB/H,EAASgI,EAASlH,IAClBsE,EAAYxE,YAAcoH,EAAStH,KACnCyE,EAAclE,MAAM0G,gBAAkB,OAAHxE,OAAU6E,EAASJ,OAAM,KAC5DvC,EAAazE,YAAcoH,EAASrB,MACpCsB,EAAUxE,SAAQ,SAAA9D,GAChBmF,EAASoD,OAAOxI,EAAWC,EAAMC,EAAcC,EAAYC,EAASC,EAAgBC,GACtF,GACJ,IACCgH,OAAM,SAAAC,GACLC,QAAQC,IAAIF,EACd,G","sources":["webpack://yandex_praktikum/./src/components/card.js","webpack://yandex_praktikum/./src/components/modal.js","webpack://yandex_praktikum/./src/components/validation.js","webpack://yandex_praktikum/./src/components/api.js","webpack://yandex_praktikum/./src/scripts/index.js"],"sourcesContent":["export function createCard (card, cardTemplate, deleteCard, addLike, openModalImage, userId) {\r\n  const newCard = cardTemplate.querySelector('.card').cloneNode(true);\r\n  const cardImage = newCard.querySelector('.card__image');\r\n  const likeButton = newCard.querySelector('.card__like-button');\r\n  const deleteButton = newCard.querySelector('.card__delete-button');\r\n  cardImage.src = card.link;\r\n  cardImage.alt = card.name;\r\n  cardImage.addEventListener('click',() => openModalImage(cardImage));\r\n  newCard.querySelector('.card__title').textContent = card.name;\r\n  if (card.owner._id === userId) {\r\n    deleteButton.addEventListener('click', () => {deleteCardFromHtml(newCard), deleteCard(card)});\r\n  } else {\r\n    deleteButton.style.display = \"none\";\r\n  }\r\n  newCard.querySelector('.card__like-count').textContent = card.likes.length\r\n  likeButton.addEventListener('click', () => {\r\n    addLike(card, userId)\r\n      .then ((res) => {\r\n        card.likes = res.likes;\r\n        newCard.querySelector('.card__like-count').textContent = res.likes.length\r\n      })\r\n    like(likeButton)\r\n  });\r\n  if (card.likes.some(user => user._id === userId)) {\r\n    likeButton.classList.add(\"card__like-button_is-active\");\r\n  }\r\n  return newCard;\r\n};\r\n\r\nfunction deleteCardFromHtml(card) {\r\n  card.remove();\r\n};\r\n\r\nfunction like(likeButton) {\r\n  likeButton.classList.toggle(\"card__like-button_is-active\");\r\n}","// Закрытие попапов\r\nexport function addCloseListeners(popup){\r\n  popup.querySelector('.popup__close').addEventListener('click',() => closePopupByButton(popup));\r\n  popup.addEventListener('click',(evt) => closePopupByOverflow(popup, evt));\r\n}\r\n\r\nfunction closePopupByButton(popup) {\r\n  closePopup(popup);\r\n}\r\n\r\nfunction closePopupByOverflow(popup, evt) {\r\n  if (evt.target === popup) {\r\n    closePopup(popup);\r\n  }\r\n};\r\n\r\nfunction closePopupByEsc(evt) {\r\n  if (evt.key === 'Escape') {\r\n    const popup = document.querySelector(\".popup_is-opened\")\r\n    closePopup(popup);\r\n  }\r\n};\r\n\r\nexport function openPopup(popup) {\r\n  popup.classList.add(\"popup_is-opened\");\r\n  document.addEventListener('keydown', closePopupByEsc);\r\n};\r\n\r\nexport function closePopup(popup) {\r\n  popup.classList.remove(\"popup_is-opened\");\r\n  document.removeEventListener('keydown', closePopupByEsc);\r\n}\r\n\r\nexport function loading(popup, isLoading) {\r\nconst button = popup.querySelector(\".popup__button\");\r\nif (isLoading) {\r\n  button.textContent = 'Сохранение...'\r\n} else {\r\n  button.textContent = 'Сохранить'\r\n}\r\n}","const validationConfig = {\r\n  formSelector: '.popup__form',\r\n  inputSelector: '.popup__input',\r\n  submitButtonSelector: '.popup__button',\r\n  inactiveButtonClass: 'popup__button_disabled',\r\n  inputErrorClass: 'popup__input_type_error',\r\n  errorClass: 'popup__error_visible',\r\n  invalidInputClass: 'popup__input_invalid'\r\n};\r\n\r\nconst showInputError = (formElement, inputElement) => {\r\n  const errorElement = formElement.querySelector(`.${inputElement.id}-error`);\r\n  inputElement.classList.add(validationConfig.inputErrorClass);\r\n  inputElement.classList.add(validationConfig.invalidInputClass);\r\n  errorElement.classList.add(validationConfig.errorClass)\r\n  if (inputElement.validity.patternMismatch) {\r\n    errorElement.textContent = inputElement.dataset.errorMessage;\r\n  } else {\r\n    errorElement.textContent = inputElement.validationMessage;\r\n  }\r\n};\r\n\r\nconst hideInputError = (formElement, inputElement) => {\r\n  const errorElement = formElement.querySelector(`.${inputElement.id}-error`);\r\n  inputElement.classList.remove(validationConfig.inputErrorClass);\r\n  inputElement.classList.remove(validationConfig.invalidInputClass);\r\n  errorElement.classList.remove(validationConfig.errorClass);\r\n  errorElement.textContent = '';\r\n};\r\n\r\nconst checkInputValidity = (formElement, inputElement) => {\r\n  if (!inputElement.validity.valid) {\r\n    showInputError(formElement, inputElement);\r\n  } else {\r\n    hideInputError(formElement, inputElement);\r\n  }\r\n};\r\n\r\nconst setEventListeners = (formElement) => {\r\n  const inputList = Array.from(formElement.querySelectorAll(validationConfig.inputSelector));\r\n  const buttonElement = formElement.querySelector(validationConfig.submitButtonSelector);\r\n\r\n  // чтобы проверить состояние кнопки в самом начале\r\n  toggleButtonState(inputList, buttonElement, validationConfig);\r\n\r\n  inputList.forEach((inputElement) => {\r\n    inputElement.addEventListener('input', function () {\r\n      checkInputValidity(formElement, inputElement);\r\n      // чтобы проверять его при изменении любого из полей\r\n      toggleButtonState(inputList, buttonElement);\r\n    });\r\n  });\r\n};\r\n\r\nexport const enableValidation = () => {\r\n  const formList = Array.from(document.querySelectorAll(validationConfig.formSelector));\r\n  formList.forEach((formElement) => {\r\n    setEventListeners(formElement);\r\n  });\r\n};\r\n\r\nexport const clearValidation = (formElement) => {\r\n  const inputList = Array.from(formElement.querySelectorAll(validationConfig.inputSelector));\r\n  inputList.forEach((inputElement) => {\r\n      hideInputError(formElement, inputElement);\r\n  });\r\n  const buttonElement = formElement.querySelector(validationConfig.submitButtonSelector);\r\n  buttonElement.disabled = true;\r\n  buttonElement.classList.add(validationConfig.inactiveButtonClass);\r\n}\r\n\r\nconst hasInvalidInput = (inputList) => {\r\n  return inputList.some((inputElement) => {\r\n  return !inputElement.validity.valid;\r\n}); \r\n};\r\n\r\nconst toggleButtonState = (inputList, buttonElement) => {\r\n  if (hasInvalidInput(inputList)) {\r\n    buttonElement.disabled = true;\r\n    buttonElement.classList.add(validationConfig.inactiveButtonClass);\r\n} else {\r\n  buttonElement.disabled = false;\r\n  buttonElement.classList.remove(validationConfig.inactiveButtonClass);\r\n}\r\n}","const config = {\r\n  baseUrl: 'https://nomoreparties.co/v1/wff-cohort-28',\r\n  headers: {\r\n    authorization: '2ce07d2c-6a68-45be-8e63-bd0f31432b5b',\r\n    'Content-Type': 'application/json'\r\n  }\r\n}\r\n\r\nexport const getInitialCards = () => {\r\n  return fetch(`${config.baseUrl}/cards`, {\r\n    headers: config.headers\r\n  })\r\n  .then(checkFetch);\r\n}\r\n\r\nexport const getUserInfo = () => {\r\n  return fetch(`${config.baseUrl}/users/me`, {\r\n    headers: config.headers\r\n  })\r\n  .then(checkFetch)\r\n}\r\n\r\nexport const updateUserInfo = (name, about) => {\r\n  return fetch(`${config.baseUrl}/users/me`, {\r\n    method: 'PATCH',\r\n    headers: config.headers,\r\n    body: JSON.stringify({\r\n      name: `${name}`,\r\n      about: `${about}`\r\n    })\r\n  })\r\n  .then(checkFetch)\r\n}\r\n\r\nexport const addCard = (newCard) => {\r\n  return fetch(`${config.baseUrl}/cards`, {\r\n    method: 'POST',\r\n    headers: config.headers,\r\n    body: JSON.stringify({\r\n      name: `${newCard.name}`,\r\n      link: `${newCard.link}`\r\n    })\r\n  })\r\n  .then (checkFetch)\r\n}\r\n\r\nexport const deleteCard = (card) => {\r\n  return fetch(`${config.baseUrl}/cards/${card._id}`, {\r\n    method: 'DELETE',\r\n    headers: config.headers\r\n  })\r\n  .then(checkFetch)\r\n}\r\n\r\nexport const addLike = (card, userId) => { \r\n  const method = card.likes.some(user => user._id === userId) ? 'DELETE' : 'PUT';\r\n  return fetch(`${config.baseUrl}/cards/likes/${card._id}`, { \r\n      method: method, \r\n      headers: config.headers \r\n  })\r\n  .then(checkFetch)\r\n}\r\n\r\nexport const updateAvatar = (url) => {\r\n  return fetch(`${config.baseUrl}/users/me/avatar`, {\r\n    method: 'PATCH',\r\n    headers: config.headers,\r\n    body: JSON.stringify({\r\n      avatar: url\r\n    })\r\n  })\r\n  .then(checkFetch)\r\n}\r\n\r\nconst checkFetch = (res) => { \r\n  if (res.ok) { \r\n      return res.json();\r\n  } \r\n  return Promise.reject(`Ошибка: ${res.status}`); \r\n}\r\n","import {createCard} from \"../components/card.js\";\r\nimport {openPopup, closePopup, addCloseListeners, loading} from \"../components/modal.js\";\r\nimport {enableValidation, clearValidation} from \"../components/validation.js\";\r\nimport {getUserInfo, getInitialCards, updateUserInfo, addCard, deleteCard, addLike, updateAvatar} from \"../components/api.js\"\r\nimport '../pages/index.css';\r\n\r\nconst cardTemplate = document.querySelector('#card-template').content;\r\nconst cardList = document.querySelector('.places__list');\r\nconst popupTypeEdit = document.querySelector('.popup_type_edit');\r\nconst popupNewCard = document.querySelector('.popup_type_new-card');\r\nconst popupImage = document.querySelector('.popup_type_image');\r\nconst popupAvatar = document.querySelector('.popup_type_avatar');\r\nconst profileAvatar = document.querySelector('.profile__image');\r\nconst profileName = document.querySelector('.profile__title');\r\nconst profileAbout = document.querySelector(\".profile__description\");\r\nlet userId;\r\n\r\nenableValidation();\r\n\r\n// Открытие попапов\r\ndocument.querySelector('.profile__edit-button').addEventListener('click',() => {openPopup(popupTypeEdit); makeDefaultProfile(); clearValidation(popupTypeEdit)});\r\ndocument.querySelector('.profile__add-button').addEventListener('click',() => {openPopup(popupNewCard); makeNewCardDefaults(); clearValidation(popupNewCard)});\r\ndocument.querySelector('.profile__image').addEventListener('click',() => {openPopup(popupAvatar); makeAvatarDefaults(); clearValidation(popupAvatar)});\r\ndocument.querySelectorAll('.popup').forEach(popup => addCloseListeners(popup)); \r\n\r\n// Редактирование профиля\r\nconst formEditProfile = document.querySelector(\".popup__form[name='edit-profile']\");\r\nconst formNewCard = document.querySelector(\".popup__form[name='new-place']\");\r\nconst formNewAvatar = document.querySelector(\".popup__form[name='avatar-change']\")\r\nconst nameInput = formEditProfile.querySelector(\".popup__input_type_name\");\r\nconst jobInput = formEditProfile.querySelector(\".popup__input_type_description\");\r\nconst avatarInput = formNewAvatar.querySelector(\".popup__input_type_avatar\");\r\n\r\n// Текущие данные профиля\r\nfunction makeDefaultProfile(){\r\n  nameInput.value = profileName.textContent;\r\n  jobInput.value = profileAbout.textContent;\r\n};\r\n\r\nmakeDefaultProfile();\r\n\r\n// Изменение профиля\r\nfunction handleEditProfileSubmit(evt) {\r\n    evt.preventDefault();\r\n    profileName.textContent = nameInput.value;\r\n    profileAbout.textContent = jobInput.value;\r\n    loading(popupTypeEdit, true)\r\n    updateUserInfo(nameInput.value, jobInput.value)\r\n      .then (closePopup(popupTypeEdit))\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n      .finally (() => {\r\n        loading(popupTypeEdit, false)\r\n      })\r\n    \r\n}\r\n\r\nformEditProfile.addEventListener('submit', handleEditProfileSubmit);\r\n\r\n// Добавление карточки\r\nconst cardNameInput = popupNewCard.querySelector(\".popup__input_type_card-name\");\r\nconst urlInput = popupNewCard.querySelector(\".popup__input_type_url\");\r\n\r\nfunction makeNewCardDefaults(){\r\n  cardNameInput.value = '';\r\n  urlInput.value = '';\r\n};\r\n\r\nfunction addNewCard(evt) {\r\n  evt.preventDefault();\r\n  const newCard = [];\r\n  newCard.name = cardNameInput.value;\r\n  newCard.link = urlInput.value;\r\n  loading(popupNewCard, true)\r\n  addCard(newCard)\r\n    .then(newCard => {\r\n      const cardElement = createCard (newCard, cardTemplate, deleteCard, addLike, openModalImage, userId);\r\n      cardList.prepend(cardElement);\r\n      closePopup(popupNewCard);\r\n      makeNewCardDefaults();\r\n    })\r\n    .catch(err => {\r\n      console.log(err);\r\n    })\r\n    .finally (() => {\r\n      loading(popupNewCard, false)\r\n    })\r\n}\r\n\r\nformNewCard.addEventListener('submit', addNewCard);\r\n\r\nfunction openModalImage(card) {\r\n  openPopup(popupImage);\r\n  popupImage.querySelector('.popup__image').src = card.src;\r\n  popupImage.querySelector('.popup__image').alt = card.alt;\r\n  popupImage.querySelector('.popup__caption').textContent = card.alt;\r\n}\r\n\r\nformNewAvatar.addEventListener('submit', editProfileAvatar);\r\n\r\nfunction makeAvatarDefaults () {\r\n  avatarInput.value = '';\r\n}\r\n\r\nfunction editProfileAvatar (evt) {\r\n  evt.preventDefault();\r\n  profileAvatar.style.backgroundImage = `url(${avatarInput.value})`;\r\n  loading(popupAvatar, true)\r\n  updateAvatar(avatarInput.value)\r\n    .then (closePopup(popupAvatar))\r\n    .catch(err => {\r\n      console.log(err);\r\n    })\r\n    .finally (() => {\r\n      loading(popupAvatar, false)\r\n    })\r\n  makeAvatarDefaults();\r\n}\r\n\r\n\r\nPromise.all([getUserInfo(), getInitialCards()])\r\n  .then(([userInfo, cardsInfo]) => {\r\n      userId = userInfo._id\r\n      profileName.textContent = userInfo.name\r\n      profileAvatar.style.backgroundImage = `url(${userInfo.avatar})`\r\n      profileAbout.textContent = userInfo.about\r\n      cardsInfo.forEach(card =>{\r\n        cardList.append(createCard(card, cardTemplate, deleteCard, addLike, openModalImage, userId))\r\n      })\r\n  })\r\n  .catch(err => {\r\n    console.log(err);\r\n  });\r\n"],"names":["createCard","card","cardTemplate","deleteCard","addLike","openModalImage","userId","newCard","querySelector","cloneNode","cardImage","likeButton","deleteButton","src","link","alt","name","addEventListener","textContent","owner","_id","remove","deleteCardFromHtml","style","display","likes","length","then","res","classList","toggle","like","some","user","add","closePopupByEsc","evt","key","closePopup","document","openPopup","popup","removeEventListener","loading","isLoading","validationConfig","formSelector","inputSelector","submitButtonSelector","inactiveButtonClass","inputErrorClass","errorClass","invalidInputClass","hideInputError","formElement","inputElement","errorElement","concat","id","clearValidation","Array","from","querySelectorAll","forEach","buttonElement","disabled","toggleButtonState","inputList","validity","valid","hasInvalidInput","config","baseUrl","headers","authorization","fetch","method","checkFetch","ok","json","Promise","reject","status","content","cardList","popupTypeEdit","popupNewCard","popupImage","popupAvatar","profileAvatar","profileName","profileAbout","patternMismatch","dataset","errorMessage","validationMessage","showInputError","checkInputValidity","setEventListeners","makeDefaultProfile","makeNewCardDefaults","makeAvatarDefaults","closePopupByButton","target","closePopupByOverflow","addCloseListeners","formEditProfile","formNewCard","formNewAvatar","nameInput","jobInput","avatarInput","value","about","preventDefault","body","JSON","stringify","catch","err","console","log","finally","cardNameInput","urlInput","addCard","cardElement","prepend","url","backgroundImage","avatar","all","_ref","_ref2","userInfo","cardsInfo","append"],"sourceRoot":""}